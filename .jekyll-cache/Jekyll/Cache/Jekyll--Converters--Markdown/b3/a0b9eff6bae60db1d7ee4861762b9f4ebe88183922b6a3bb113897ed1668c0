I"·<p>iostatå‘½ä»¤æ˜¯æŠ¥å‘Šcpuçš„ç»Ÿè®¡ä¿¡æ¯å’Œç£ç›˜çš„i/oç»Ÿè®¡ä¿¡æ¯ã€‚iostatå‘½ä»¤é€šè¿‡è§‚å¯Ÿå­˜å‚¨è®¾å¤‡å®é™…çš„å·¥ä½œæ—¶é—´å’Œå®ƒä»¬çš„å¹³å‡ä¼ è¾“ç‡æ¥ç›‘æ§ç³»ç»Ÿçš„i/oè´Ÿè½½ã€‚
è¿™ä¸ªä¸éœ€è¦rootæƒé™ï¼Œæ•°æ®æ¥æºå¯ä»¥ç›´æ¥é€šè¿‡è®¿é—®procfsè·å–ã€‚</p>
<h1 id="åŸºæœ¬ç”¨æ³•å’Œè¾“å‡ºçš„åŸºæœ¬å«ä¹‰">åŸºæœ¬ç”¨æ³•å’Œè¾“å‡ºçš„åŸºæœ¬å«ä¹‰</h1>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iostat <span class="nt">-d</span> <span class="nt">-x</span> 1#è¡¨ç¤ºæ˜¾ç¤ºè®¾å¤‡çŠ¶æ€ï¼Œæ˜¾ç¤ºæ‰©å±•ä¿¡æ¯ï¼Œæ¯ç§’è¾“å‡ºä¸€æ¬¡
</code></pre></div></div>
<p>![iostat][0]</p>
<h2 id="iostatæŒ‡æ ‡è§£è¯»">iostatæŒ‡æ ‡è§£è¯»</h2>

<table>
  <thead>
    <tr>
      <th>æ€§èƒ½æŒ‡æ ‡</th>
      <th>å«ä¹‰</th>
      <th>æç¤º</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Device</td>
      <td>æ˜¾ç¤ºè®¾å¤‡æˆ–è€…åˆ†åŒºçš„Name</td>
      <td>è¿™äº›è®¾å¤‡å¯ä»¥åœ¨/devä¸‹æ‰¾åˆ°</td>
    </tr>
    <tr>
      <td>r/s</td>
      <td>æ¯ç§’å‘é€ç»™ç£ç›˜çš„è¯·æ±‚æ•°</td>
      <td>åˆå¹¶åçš„è¯·æ±‚æ•°</td>
    </tr>
    <tr>
      <td>w/s</td>
      <td>æ¯ç§’å‘é€ç»™ç£ç›˜çš„è¯·æ±‚æ•°</td>
      <td>åˆå¹¶åçš„è¯·æ±‚æ•°</td>
    </tr>
    <tr>
      <td>rkB/s</td>
      <td>æ¯ç§’ä»ç£ç›˜è¯»å–çš„æ•°æ®é‡</td>
      <td>å•ä½ä¸ºkB</td>
    </tr>
    <tr>
      <td>wkB/s</td>
      <td>æ¯ç§’å‘ç£ç›˜å†™å…¥çš„æ•°æ®é‡</td>
      <td>å•ä½ä¸ºkB</td>
    </tr>
    <tr>
      <td>rrqm/s</td>
      <td>æ¯ç§’åˆå¹¶çš„è¯»è¯·æ±‚æ•°</td>
      <td>%rrqmè¡¨ç¤ºåˆå¹¶è¯»è¯·æ±‚çš„ç™¾åˆ†æ¯”</td>
    </tr>
    <tr>
      <td>wrqm/s</td>
      <td>æ¯ç§’åˆå¹¶çš„å†™è¯·æ±‚æ•°</td>
      <td>%wrqmè¡¨ç¤ºåˆå¹¶å†™è¯·æ±‚çš„ç™¾åˆ†æ¯”</td>
    </tr>
    <tr>
      <td>r_await</td>
      <td>è¯»è¯·æ±‚å¤„ç†å®Œæˆç­‰å¾…æ—¶é—´</td>
      <td>åŒ…æ‹¬é˜Ÿåˆ—ä¸­çš„ç­‰å¾…æ—¶é—´å’Œè®¾å¤‡å®é™…å¤„ç†çš„æ—¶é—´ï¼Œå•ä½ms</td>
    </tr>
    <tr>
      <td>w_await</td>
      <td>å†™è¯·æ±‚å¤„ç†å®Œæˆç­‰å¾…æ—¶é—´</td>
      <td>åŒ…æ‹¬é˜Ÿåˆ—ä¸­çš„ç­‰å¾…æ—¶é—´å’Œè®¾å¤‡å®é™…å¤„ç†çš„æ—¶é—´ï¼Œå•ä½ms</td>
    </tr>
    <tr>
      <td>aqu-sz</td>
      <td>å¹³å‡è¯·æ±‚é˜Ÿåˆ—é•¿åº¦</td>
      <td>æ—§ç‰ˆæœ¬ä¸­ä¸ºavgqu-sz</td>
    </tr>
    <tr>
      <td>rareq-sz</td>
      <td>å¹³å‡è¯»è¯·æ±‚å¤§å°</td>
      <td>å•ä½ä¸ºkB</td>
    </tr>
    <tr>
      <td>wareq-sz</td>
      <td>å¹³å‡å†™è¯·æ±‚å¤§å°</td>
      <td>å•ä½ä¸ºkB</td>
    </tr>
    <tr>
      <td>svctm</td>
      <td>å¤„ç†IOè¯·æ±‚æ‰€éœ€çš„å¹³å‡æ—¶é—´<br />ï¼ˆä¸åŒ…æ‹¬ç­‰å¾…æ—¶é—´ï¼‰</td>
      <td>å•ä½ä¸ºæ¯«ç§’</td>
    </tr>
    <tr>
      <td>%util</td>
      <td>ç£ç›˜å¤„ç†IOçš„æ—¶é—´ç™¾åˆ†æ¯”</td>
      <td>å³ä½¿ç”¨ç‡ï¼Œç”±äºå¯èƒ½å­˜åœ¨å¹¶è¡ŒIOï¼Œ100%ä¸è¡¨æ˜ç£ç›˜IOé¥±å’Œ</td>
    </tr>
  </tbody>
</table>

<h1 id="iostatæ•°æ®æ¥æºdiskstats">iostatæ•°æ®æ¥æºdiskstats</h1>
<p>è¿™é‡Œçš„æ•°æ®æ¥æºæŒ‡çš„æ˜¯/proc/diskstats
![diskstats][1]</p>

<p>iostatæ˜¯ä»¥/proc/diskstatsä¸ºåŸºç¡€è®¡ç®—å‡ºæ¥çš„ï¼Œè¿™æ˜¯å‰æã€‚è€Œä¸”å¾ˆå¤šæŸ¥IOçš„æ–¹æ³•éƒ½æ˜¯é€šè¿‡/proc/diskstatsä¸ºåŸºç¡€è®¡ç®—å‡ºæ¥çš„ã€‚</p>

<p>ç”±äº/proc/diskstatså¹¶æœªæŠŠé˜Ÿåˆ—ç­‰å¾…æ—¶é—´å’Œç¡¬ç›˜å¤„ç†æ—¶é—´åˆ†å¼€ï¼Œæ‰€ä»¥å‡¡æ˜¯ä»¥å®ƒä¸ºåŸºç¡€çš„å·¥å…·éƒ½ä¸å¯èƒ½åˆ†åˆ«æä¾›disk service timeä»¥åŠä¸queueæœ‰å…³çš„å€¼ã€‚</p>

<p>è¿™é‡Œä¸¾<code class="highlighter-rouge">sda</code>ä¸ºä¾‹</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8 0 sda 63147 32179 3914580 61983 287312 216951 7881680 434138 0 190628 267912 0 0 0 0
</code></pre></div></div>
<p>æ¯ä¸ªå‚æ•°å¯¹åº”çš„å«ä¹‰:
å‰3ä¸ªå­—æ®µåˆ†åˆ«ä»£è¡¨major, minor, device</p>

<p>|Name      |      units   |     description|
|â€”â€”     |      â€”â€”   |    â€”â€”  |
|read I/Os       |requests      |number of read I/Os processed|
|read merges     |requests      |number of read I/Os merged with in-queue I/O|
|read sectors    |sectors       |number of sectors read|
|read ticks      |milliseconds  |total wait time for read requests|
|write I/Os      |requests      |number of write I/Os processed|
|write merges    |requests      |number of write I/Os merged with in-queue I/O|
|write sectors   |sectors       |number of sectors written|
|write ticks     |milliseconds  |total wait time for write requests|
|in_flight       |requests      |number of I/Os currently in flight|
|io_ticks        |milliseconds  |total time this block device has been active|
|time_in_queue   |milliseconds  |total wait time for all requests|
|discard I/Os    |requests      |number of discard I/Os processed|
|discard merges  |requests      |number of discard I/Os merged with in-queue I/O|
|discard sectors |sectors       |number of sectors discarded|
|discard ticks   |milliseconds  |total wait time for discard requests|
[0]: /img/perf/iostat.png
[1]: /img/perf/diskstats.png</p>

:ET