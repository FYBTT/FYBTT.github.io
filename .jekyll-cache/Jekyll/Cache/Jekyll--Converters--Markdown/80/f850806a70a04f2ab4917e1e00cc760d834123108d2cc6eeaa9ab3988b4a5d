I"ön<h1 id="dsoæ€»ç»“">DSOæ€»ç»“</h1>

<blockquote>
  <p>è®ºæ–‡ã€ŠDirect Sparse Odometryã€‹çš„é˜…è¯»ç¬”è®°ã€‚</p>
</blockquote>

<h2 id="1-calibration">1. Calibration</h2>

<p>DSOä¸­ç»“åˆäº†å‡ ä½•æ ¡æ­£å’Œå…‰åº¦æ ¡æ­£ä¸¤ä¸ªæ¨¡å‹ï¼Œå…¶ä¸­å‡ ä½•æ ¡æ­£ä¸ºå°å­”ç›¸æœºæ¨¡å‹ã€‚</p>

<h4 id="å…‰åº¦æ ¡æ­£">å…‰åº¦æ ¡æ­£</h4>

<p>å…‰åº¦æˆåƒæ¨¡å‹ä¸º</p>

<script type="math/tex; mode=display">I_i(x)=G(t_iV(\boldsymbol x)B_i(\boldsymbol x))</script>

<p>å…¶ä¸­ï¼Œ$t_i$ä¸ºæ›å…‰æ—¶é—´ï¼Œ$I_i(x)$ä¸ºå›¾åƒåƒç´ å€¼ï¼Œ$G$ä¸ºç›¸æœºçš„å“åº”å‡½æ•°ï¼Œæ˜¯ç›¸æœºçš„å›ºæœ‰å±æ€§ã€‚$V$å»ºæ¨¡å…‰å­¦å…ƒä»¶é€é•œçš„å½±å“ï¼Œå³å›¾åƒä¸­å¿ƒå’Œè¾¹ç¼˜çš„äº®åº¦å€¼ä¸ä¸€è‡´(vignetting)ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚$B_i$æ˜¯è¾ç…§åº¦(irradiance)ï¼Œè¡¨ç¤ºç›¸æœºä¼ æ„Ÿå™¨æ¥æ”¶åˆ°çš„å…¥å°„å…‰å¼ºã€‚</p>
<div align="center">
<img src="/img/post_vignetting.png" />
</div>
<p>å› æ­¤å¯¹å›¾åƒçš„å…‰åº¦æ ¡æ­£æ¨¡å‹ä¸º</p>

<script type="math/tex; mode=display">I_i^{'}(x)=t_iB_i(x)=\frac{G^{-1}(I_i(x))}{V(x)}</script>

<p>è¯¥æ ¡æ­£æ¨¡å‹å»é™¤äº†vignettingçš„å½±å“ã€‚<font color="blue">ï¼ˆä¸ºä»€ä¹ˆæœ€åä¸åŠ ä¸Šå“åº”å‡½æ•°$G$ï¼Ÿï¼Œå³$I_i'(x)=G(t_iB_i(x))$ï¼‰</font>åæ–‡ä¸­çš„$I(x)$å‡æŒ‡å…‰åº¦æ ¡æ­£è¿‡çš„å€¼ã€‚</p>

<font color="blue">å‡ ä½•æ ¡æ­£å’Œå…‰åº¦æ ¡æ­£æ˜¯æ€ä¹ˆåŒæ—¶åšçš„ï¼Œå…ˆé€šè¿‡å‡ ä½•æ ‡å®šå»é™¤ç•¸å˜ï¼Œå†ç»™å»é™¤ç•¸å˜çš„å›¾åƒåšå…‰åº¦æ ‡å®šï¼Ÿ</font>
<font color="red">åªè¦å…‰åº¦æ ‡å®šå‚æ•°æ˜¯åœ¨å»é™¤ç•¸å˜çš„åŸºç¡€ä¸Šå¾—åˆ°çš„ï¼Œå‡ ä½•æ ‡å®šå’Œå…‰åº¦æ ‡å®šå°±ä¸ä¼šç›¸äº’å½±å“ã€‚</font>

<h2 id="2-å…‰åº¦è¯¯å·®æ¨¡å‹">2. å…‰åº¦è¯¯å·®æ¨¡å‹</h2>

<p>å¯¹äºhostå¸§$i$ä¸­çš„ç‚¹$\boldsymbol p$, å…¶åœ¨targetå¸§$j$ä¸­çš„æŠ•å½±ä¸º$\boldsymbol pâ€™$ï¼Œåˆ™å®šä¹‰è¯¥ç‚¹åœ¨è¿™ä¸¤å¸§ä¸­çš„å…‰åº¦è¯¯å·®ä¸º</p>

<script type="math/tex; mode=display">\begin{equation}
E_{\boldsymbol p_j}=\sum_{\boldsymbol p\in N_p}w_p||(I_j[\boldsymbol p']-b_j)-\frac{t_je^{a_j}}{t_ie^{a_i}}(I_i[\boldsymbol p]-b_i)||_\gamma
\end{equation}</script>

<p>å…¶ä¸­$w_p=\frac{c^2}{c^2+||\nabla I_i(\boldsymbol p)||_2^2}$ä¸ºæƒé‡ï¼Œåƒç´ çš„æ¢¯åº¦è¶Šé«˜ï¼Œåˆ™å…¶æƒé‡è¶Šå°ã€‚<font color="blue">å‡å°å™ªå£°ç‚¹çš„å½±å“ï¼Ÿ</font></p>

<p>$N_p$è¡¨ç¤ºresidual patternï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨æ¯ä¸ªç‚¹å‘¨å›´é€‰æ‹©7ä¸ªç‚¹ï¼Œå¿½ç•¥å³ä¸‹è§’ç‚¹æ˜¯ä¸ºäº†ä½¿ç”¨SSEåŠ é€Ÿã€‚å› æ­¤æ¯ä¸ªç‚¹çš„å…‰åº¦è¯¯å·®æ˜¯8ä¸ªç‚¹çš„è¯¯å·®ä¹‹å’Œã€‚</p>
<div align="center">
<img src="/img/post_residual_pattern.jpg" />
</div>
<p>ä¸ºäº†å¤„ç†æ›å…‰æ—¶é—´æœªçŸ¥çš„æƒ…å†µï¼Œæ·»åŠ äº†ä¸€ä¸ªä»¿å°„äº®åº¦å˜æ¢å‡½æ•°(affine brightness transfer function)$e^{-a_i}(I_i-b_i)$ã€‚<font color="red">ï¼ˆé€šè¿‡è¯¥å‡½æ•°æ¥å¤§è‡´æ‹Ÿåˆæˆåƒè¿‡ç¨‹ï¼Œä»è€Œæ¶ˆé™¤å…‰åº¦è¯¯å·®, $e^{-a}$ç”¨äºæ ¡æ­£æ›å…‰æ—¶é—´ã€$b_i$ç”¨äºæ ¡æ­£å›¾åƒäº®åº¦åŸºåº•çš„å½±å“[5]ï¼‰</font></p>

<p>å¯¹äºæœªè¿›è¡Œå…‰åº¦æ ‡å®šçš„å›¾åƒï¼Œåˆ™$G=V=t=1$ï¼Œå³$I_i^{â€˜}(x)=I_i(x)$ã€‚<br />
å¯¹äºå·²è¿›è¡Œå…‰åº¦æ ‡å®šçš„å›¾åƒï¼Œ$a,b$ä¸º0æˆ–å¾ˆå°çš„æ•°ï¼Œå› æ­¤ä¸Šå¼ç­‰ä»·äº</p>

<script type="math/tex; mode=display">E_{\boldsymbol p_j}=\sum_{\boldsymbol p\in N_p}w_p||I_j[\boldsymbol p']-\frac{t_j}{t_i}I_i[\boldsymbol p]||_\gamma</script>

<p>åˆ™æœ€ç»ˆè®¡ç®—çš„æ˜¯ä¸¤å¼ å›¾åƒä¹‹é—´çš„è¾ç…§åº¦($B$)çš„è¯¯å·®ã€‚ 
æ€»çš„å…‰åº¦è¯¯å·®ä¸º</p>

<script type="math/tex; mode=display">\begin{equation}
E_{photo}=\sum_{i\in F}\sum_{\boldsymbol p\in P_i}\sum_{j\in obs(\boldsymbol p)}E_{\boldsymbol p_j}
\end{equation}</script>

<p>å…¶ä¸­ï¼Œ$F$è¡¨ç¤ºæ‰€æœ‰å¸§<font color="blue">(key frameè¿˜æ˜¯active frameè¿˜æ˜¯æ‰€æœ‰æ™®é€šçš„frameï¼Ÿ)</font>çš„é›†åˆï¼Œ$P_i$è¡¨ç¤ºå¸§$F_i$ä¸­çš„æ‰€æœ‰ç‚¹<font color="blue">(candidate pointï¼Ÿactive point?)</font>ï¼Œ$obs(\boldsymbol p)$è¡¨ç¤ºæ‰€æœ‰è§‚æµ‹åˆ°$\boldsymbol p$ç‚¹çš„å…¶ä»–å¸§ã€‚<font color="red">åç»­é€šè¿‡æ»‘åŠ¨çª—å£æœ€å°åŒ–è¯¥è¯¯å·®å€¼ï¼Œåˆ™$F$æ˜¯æ»‘åŠ¨çª—å£å†…çš„æ‰€æœ‰å¸§ï¼Œç›²çŒœå¸§å’Œç‚¹éƒ½æ˜¯activeã€‚</font><br />
æœ€ç»ˆæ„å»ºçš„å› å­å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div align="center">
<img src="/img/post_factor_graph.png" />
</div>
<p>åœ¨æ›å…‰æ—¶é—´å·²çŸ¥å¹¶ä¸”å·²è¿›è¡Œå…‰åº¦æ ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿˜ä¼šåŠ å…¥ä¸€ä¸ªæ­£åˆ™é¡¹ç”¨æ¥çº¦æŸ$a,b$çš„å¤§å°(æ­¤æ—¶$a,b$çš„ä½œç”¨å·²ç”±å…‰åº¦æ ‡å®šå®Œæˆ)ï¼š</p>

<script type="math/tex; mode=display">E_{prior}=\sum_{i\in F}(\lambda_aa_i^2+\lambda_bb_i^2)</script>

<h2 id="3-windowed-optimization--marginalization">3. Windowed Optimization &amp; Marginalization</h2>

<p>æ»‘åŠ¨çª—å£ä¼˜åŒ–ä½¿ç”¨GNæ–¹æ³•ï¼Œåˆ™</p>

<script type="math/tex; mode=display">\boldsymbol H =\boldsymbol{J}^T\boldsymbol{WJ} \\
\boldsymbol b = -\boldsymbol{J}^T\boldsymbol{Wr}</script>

<p>$\boldsymbol W$æ˜¯æƒé‡çŸ©é˜µ<font color="blue">ï¼ˆæ€ä¹ˆå¾—åˆ°çš„ï¼Ÿï¼‰</font><font color="red">ï¼ˆå…¬å¼1ä¸­çš„$w_p$ï¼‰</font>ï¼Œ$\boldsymbol J$çš„æ¨å¯¼è§ä¸‹ä¸€èŠ‚ã€‚<br />
$\boldsymbol J_k$çš„å½¢å¼ä¸º</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\boldsymbol{J}_k &= \frac{\partial r_k((\boldsymbol{\delta}+\boldsymbol{x})\boxplus\boldsymbol{\zeta}_0)}{\partial \boldsymbol{\delta}} \\
&=
\left[
\begin{matrix}
\underbrace{\frac{\partial I_j}{\partial \boldsymbol p'}}_{\boldsymbol J_I}\underbrace{\frac{\partial \boldsymbol p'((\boldsymbol{\delta}+\boldsymbol{x})\boxplus\boldsymbol{\zeta}_0)}{\partial \boldsymbol \delta_{geo}}}_{\boldsymbol J_{geo}},\end{matrix}
\begin{matrix}
\underbrace{\frac{\partial r_k((\boldsymbol{\delta}+\boldsymbol{x})\boxplus\boldsymbol{\zeta}_0)}{\partial \boldsymbol \delta_{photo}}}_{\boldsymbol J_{photo}}
\end{matrix}
\right]
\end{align} %]]></script>

<font color="blue">ï¼ˆå¤ªéš¾çœ‹äº†ï¼Œæ€ä¹ˆæŠŠå¤§æ‹¬å·æ”¾çŸ©é˜µå¤–é¢ï¼Ÿï¼‰</font>

<p>ä½¿ç”¨æ»‘åŠ¨çª—å£æ—¶ï¼Œä¸ºäº†å‡å°è®¡ç®—é‡ï¼Œéœ€è¦å°†éƒ¨åˆ†å˜é‡ç§»å‡ºçª—å£ï¼Œè‹¥æ˜¯ç›´æ¥ä¸¢æ‰è¿™äº›å˜é‡ï¼Œåˆ™ä¼šç ´ååŸæœ‰çš„çº¦æŸå…³ç³»ï¼ŒæŸå¤±çº¦æŸä¿¡æ¯ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨è¾¹ç¼˜åŒ–ï¼Œå°†çº¦æŸä¿¡æ¯è½¬åŒ–ä¸ºå¾…ä¼˜åŒ–å˜é‡çš„å…ˆéªŒåˆ†å¸ƒï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªä»è”åˆæ¦‚ç‡å¯†åº¦åˆ†å¸ƒè·å¾—è¾¹ç¼˜æ¦‚ç‡å¯†åº¦åˆ†å¸ƒçš„è¿‡ç¨‹[6]ã€‚è¢«è¾¹ç¼˜åŒ–çš„å˜é‡å¯èƒ½å’Œå‰©ä½™çš„å˜é‡ä¹‹é—´æœ‰çº¦æŸï¼Œå› æ­¤è‹¥ç›´æ¥ä¸¢å¼ƒè¯¥å˜é‡ï¼Œåˆ™çº¦æŸä¹Ÿè¢«èˆå¼ƒäº†ï¼Œåœ¨åç»­çš„ä¼˜åŒ–è¿‡ç¨‹ä¸­åŠ¿å¿…ä¼šç ´åè¯¥çº¦æŸï¼Œè€Œè¾¹ç¼˜åŒ–æ˜¯å°†è¯¥çº¦æŸä¿¡æ¯è½¬æ¢ä¸ºå‰©ä½™å˜é‡çš„å…ˆéªŒä¿¡æ¯[7]ã€‚<font color="red">ä¹Ÿæ˜¯ç”±äºè¯¥å…ˆéªŒä¿¡æ¯çš„å­˜åœ¨è€Œéœ€è¦ä½¿ç”¨FEJç­–ç•¥å·²ä¿æŒä¸€è‡´æ€§ã€‚ä¾‹å¦‚ï¼Œå½“å‰ä¼˜åŒ–çŠ¶æ€é‡ä¸º$[x, y]$ï¼Œéœ€è¦è¾¹ç¼˜åŒ–$x$ï¼Œæ­¤æ—¶$y$åœ¨$(x_0, y_0)$å¤„çº¿æ€§åŒ–ï¼Œåˆ™å¾—åˆ°ä¸€ä¸ªå…ˆéªŒçš„HessiançŸ©é˜µ$H_0$ï¼Œæ­¤æ—¶æ–°åŠ å…¥å˜é‡$z$ï¼Œåˆ™ä¼˜åŒ–å˜é‡å˜ä¸º$[y,z]$ï¼Œä½†æ˜¯æ­¤æ—¶$y$å·²ç»æ›´æ–°ï¼Œå› æ­¤å†æ¬¡ä¼˜åŒ–çš„æ—¶å€™ä¼šåœ¨$(y_1,z_0)$å¤„è¿›è¡Œçº¿æ€§åŒ–ï¼Œå¾—åˆ°æ–°çš„HessiançŸ©é˜µ$H_1$ï¼Œåˆ™æ±‚è§£çš„å¢é‡æ–¹ç¨‹å˜ä¸º$(H_0+H_1)x=b$[10]ã€‚</font><font color="blue">æ‰€ä»¥$z$æ˜¯åœ¨$(y_1,z_0)$å¤„çº¿æ€§åŒ–ï¼Œè€Œç”±äºå…ˆéªŒ$H$çš„å­˜åœ¨ï¼Œ$y$ä¸æ˜¯åœ¨è¯¥ç‚¹çº¿æ€§åŒ–ï¼Œå› æ­¤å¯¼è‡´ä¸ä¸€è‡´æ€§çš„é—®é¢˜ï¼Ÿä½†æ˜¯ç”¨äº†FEJä»¥å$y$å’Œ$z$ä»ç„¶ä¸æ˜¯åœ¨åŒä¸€ç‚¹çº¿æ€§åŒ–çš„ã€‚</font><font color="red">ä¸åŒçš„çº¿æ€§åŒ–ç‚¹å¹¶ä¸æ˜¯ç›¸å¯¹äºä¸åŒçš„å˜é‡è€Œè¨€çš„ï¼Œè€Œæ˜¯æŒ‡å‡½æ•°ä¸¤æ¬¡çº¿æ€§åŒ–æ—¶çš„ç‚¹ï¼ˆå˜é‡çš„å€¼ï¼‰æ˜¯ç›¸åŒçš„ï¼Œè‹¥åœ¨ä¸åŒçš„ç‚¹çº¿æ€§åŒ–ä¸¤æ¬¡åçš„åŠ å’Œå°±å¯èƒ½å¯¼è‡´é›¶ç©ºé—´çš„é™ç»´ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ$E_1$å’Œ$E_2$åœ¨ä¸åŒçš„ç‚¹çº¿æ€§åŒ–åä½¿åŸå‡½æ•°çš„é›¶ç©ºé—´æ¶ˆå¤±ã€‚</font></p>
<font color="blue">EFJå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ</font>
<font color="red">$H_0$åªåŒ…å«å…ˆéªŒä¿¡æ¯ï¼Œå› æ­¤åªæœ‰åœ¨ä¸Šä¸€æ¬¡è¾¹ç¼˜åŒ–æ—¶å¢åŠ äº†å…ˆéªŒçš„å˜é‡æ‰æœ‰å€¼ï¼Œå…¶ä½™å‡ä¸º0ï¼Œæ‰€ä»¥åŠ ä¸Š$H_0$ä¸ä¼šå¯¹å…¶ä»–å˜é‡æœ‰å½±å“ï¼Œå› æ­¤ä¸‹ä¸€æ¬¡ä¼˜åŒ–æ—¶ï¼Œåªéœ€è¿™äº›å˜é‡åœ¨åˆå§‹å€¼å¤„çº¿æ€§åŒ–å³å¯ï¼Œè¿­ä»£è¿‡ç¨‹ä¸æ›´æ–°ï¼Œä¼˜åŒ–å®Œæˆåå†æ›´æ–°ã€‚</font>

<div align="center">
<img src="/img/post_nullspace_demo.png" />
</div>

<p>è¯¯å·®å‡½æ•°$r_k$ä¸­å­˜åœ¨éçº¿æ€§é›¶ç©ºé—´(nullspace)ï¼ˆå³è¯¥å˜é‡çš„å˜åŒ–ä¸ä¼šå½±å“$r_k$çš„å˜åŒ–ï¼ŒDSOä¸­æ˜¯å°ºåº¦å’Œç»å¯¹ä½å§¿ï¼‰ï¼Œå› æ­¤è‹¥åœ¨ä¸åŒçš„ç‚¹å¯¹è¿™äº›å˜é‡è¿›è¡Œçº¿æ€§åŒ–ï¼Œåˆ™ä¼šå¯¼è‡´é›¶ç©ºé—´çš„é™ç»´ï¼Œç›¸å½“äºå¼•å…¥äº†é”™è¯¯çš„ä¿¡æ¯ï¼Œä½¿ä¸å¯è§‚çŠ¶æ€é‡å˜å¾—å¯è§‚äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å¯¹è¿™äº›ä¸å¯è§‚å˜é‡åŒæ—¶è¿›è¡Œçº¿æ€§åŒ–ï¼Œå³First Estimate Jacobiansï¼Œ$\boldsymbol J_{geo},\boldsymbol J_{photo}$å‡åœ¨$\boldsymbol \xi_0$å¤„è¿›è¡Œè®¡ç®—ï¼Œæ¯æ¬¡è¿­ä»£æ—¶åªæ›´æ–°$x$ï¼Œä¸€æ¬¡ä¼˜åŒ–å®Œæˆåæ›´æ–°$\xi_0$ã€‚$\boldsymbol J_{geo},\boldsymbol J_{photo}$æ˜¯è¶³å¤Ÿå…‰æ»‘çš„ï¼Œå› æ­¤å®é™…ä½¿ç”¨ä¸­ï¼Œæ•ˆæœå¾ˆå¥½ã€‚</p>

<p>è¾¹ç¼˜åŒ–æŸä¸€å¸§æ—¶ï¼Œé¦–å…ˆè¾¹ç¼˜åŒ–è¯¥å¸§ä¸­çš„æ‰€æœ‰active pointä»¥åŠæ‰€æœ‰æœ€è¿‘ä¸¤å¸§ä¸­æœªè§‚æµ‹åˆ°çš„ç‚¹ï¼Œè¯¥å¸§çš„active pointåœ¨å…¶ä»–å¸§ä¸­çš„observationç›´æ¥ä¸¢å¼ƒ<font color="blue">ï¼ˆæ€ä¹ˆç›´æ¥ä¸¢å¼ƒï¼Ÿç›´æ¥å°†$H$ä¸­å¯¹åº”çš„è¡Œåˆ—ç½®ä¸º0ï¼Ÿï¼‰</font><font color="red">ï¼ˆç›´æ¥ç½®ä¸º0ã€‚ï¼‰</font></p>

<font color="blue">
é—®é¢˜ï¼š  
</font>
<ol>
  <li>åªåœ¨ä¸€æ¬¡ä¼˜åŒ–çš„6æ¬¡è¿­ä»£ä¸­ä½¿ç”¨FEJï¼Œä¸‹æ¬¡ä¼˜åŒ–æ—¶ä¼šé‡æ–°è®¡ç®—JacobiançŸ©é˜µï¼Ÿ</li>
  <li>å…ˆéªŒHessiançŸ©é˜µ$H$æ˜¯ä¸€ä¸ªå•ç‹¬çš„çŸ©é˜µï¼Ÿ$H$ä¼šåœ¨æ•´ä¸ªç¨‹åºè¿è¡ŒæœŸé—´ä¸€ç›´ç»´æŠ¤ï¼Œæ¯æ¬¡è¿›è¡Œè¾¹ç¼˜åŒ–çš„æ—¶å€™è¿›è¡Œç´¯åŠ ï¼Ÿè¿˜æ˜¯åªä¿ç•™æœ€æ–°çš„ï¼Ÿ</li>
  <li>è¾¹ç¼˜åŒ–æ—§çš„çŠ¶æ€é‡ï¼Œæ·»åŠ æ–°çš„çŠ¶æ€é‡å’Œä¼˜åŒ–çš„æ—¶æœºï¼Ÿåˆ›å»ºäº†æ–°çš„å…³é”®å¸§åï¼Œéœ€è¦è¾¹ç¼˜åŒ–æ—§çš„ï¼Œä¼˜åŒ–æ€ä¹ˆè¿›è¡Œï¼Ÿè¿›è¡Œä¸€æ¬¡ä¼˜åŒ–ï¼Œå‰å‡ æ¬¡è¿­ä»£è¾¹ç¼˜åŒ–ï¼Œåå‡ æ¬¡è¿­ä»£ä¼˜åŒ–æ–°åŠ å…¥çš„çŠ¶æ€ï¼Ÿ<font color="red">ï¼ˆé”™ï¼Œä¸€æ¬¡è¿­ä»£ä¸­çš„$H$æ˜¯ä¸å˜çš„ï¼Ÿï¼ï¼‰</font>æˆ–ä¸€æ¬¡ä¼˜åŒ–ä¸­ä¸è€ƒè™‘æ–°åŠ å…¥çš„å˜é‡ï¼Œåªæ˜¯è¾¹ç¼˜æ‰æ—§çš„çŠ¶æ€é‡ï¼Œæ›´æ–°å‰©ä½™å˜é‡åç›´æ¥æŠŠæ–°åŠ å…¥çš„çŠ¶æ€é‡åŠ å…¥åˆ°çª—å£ä¸­ï¼Œè€Œä¸è¿›è¡Œä¼˜åŒ–ï¼Œä¸‹ä¸€æ¬¡è¾¹ç¼˜åŒ–çš„æ—¶å€™å†ä¼˜åŒ–ï¼Ÿï¼ˆæ„Ÿè§‰ä¹Ÿä¸å¤ªå¯èƒ½ï¼‰æˆ–è€…è¿›è¡Œä¸¤æ¬¡ä¼˜åŒ–ï¼Œç¬¬ä¸€æ¬¡è¾¹ç¼˜åŒ–ï¼Œç¬¬äºŒæ¬¡ä¼˜åŒ–æ–°å˜é‡ï¼Ÿ</li>
  <li>ä¸åŒçš„çº¿æ€§åŒ–ç‚¹æ˜¯å¦‚ä½•å‡ºç°çš„ï¼Ÿ</li>
  <li>å…ˆéªŒHessiançŸ©é˜µæ€ä¹ˆè®¡ç®—çš„ï¼Ÿ</li>
</ol>

<h2 id="4-jacobiançŸ©é˜µæ¨å¯¼">4. JacobiançŸ©é˜µæ¨å¯¼</h2>

<p>æ®‹å·®å…¬å¼ä¸ºï¼š</p>

<script type="math/tex; mode=display">\begin{equation}
r_k = (I_j[\boldsymbol p'(\boldsymbol T_i,\boldsymbol T_j,d,\boldsymbol{c})]-b_j)-\frac{t_je^{a_j}}{t_ie^{a_i}}(I_i[p]-b_i)
\end{equation}</script>

<p>ä¸‹æ ‡$i$è¡¨ç¤ºhost frame, $j$è¡¨ç¤ºtarget frameã€‚<br />
åˆ™</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\boldsymbol{J}_k &= \frac{\partial r_k((\boldsymbol{\delta}+\boldsymbol{x})\boxplus\boldsymbol{\zeta}_0)}{\partial \boldsymbol{\delta}} \\
&=
\left[
\begin{matrix}
\frac{\partial I_j}{\partial \boldsymbol p'}\frac{\partial \boldsymbol p'((\boldsymbol{\delta}+\boldsymbol{x})\boxplus\boldsymbol{\zeta}_0)}{\partial \boldsymbol \delta_{geo}}, \frac{\partial r_k((\boldsymbol{\delta}+\boldsymbol{x})\boxplus\boldsymbol{\zeta}_0)}{\partial \boldsymbol \delta_{photo}}
\end{matrix}
\right]
\end{align} %]]></script>

<p>å…¶ä¸­ï¼Œ$\boldsymbol \delta$åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼Œ$\boldsymbol \delta_{geo}$ï¼šå‡ ä½•å‚æ•°ï¼ˆ$\boldsymbol T_i, \boldsymbol T_j, d, \boldsymbol{c}$ï¼‰å’Œ$\boldsymbol \delta_{photo}$:å…‰åº¦å‚æ•°ï¼ˆ$a_i,a_j,b_i,b_j$ï¼‰ã€‚</p>

<h3 id="40-å›¾åƒæ¢¯åº¦">4.0 å›¾åƒæ¢¯åº¦</h3>

<font color="red">
$$
\begin{equation}
\frac{\partial I_j}{\partial \boldsymbol p'}=[I_u, I_v,0]
\end{equation}
$$
</font>

<p>$I_u,I_v$åˆ†åˆ«è¡¨ç¤ºå›¾åƒåœ¨$u,v$æ–¹å‘çš„æ¢¯åº¦ã€‚</p>

<h3 id="41-å…‰åº¦å‚æ•°a_ia_jb_ib_j">4.1 å…‰åº¦å‚æ•°ï¼ˆ$a_i,a_j,b_i,b_j$ï¼‰</h3>

<p>å…‰åº¦å‚æ•°ç›´æ¥æ±‚å¯¼å³å¯ã€‚</p>

<font color="red">
$$
\begin{align}
\frac{\partial r_k}{\partial a_i} &amp;= \frac{t_je^{a_j}}{t_ie^{a_i}}(I_i[\boldsymbol p]-b_i) \\
\frac{\partial r_k}{\partial a_j} &amp;= -\frac{t_je^{a_j}}{t_ie^{a_i}}(I_i[\boldsymbol p]-b_i) \\
\frac{\partial r_k}{\partial b_i} &amp;= \frac{t_je^{a_j}}{t_ie^{a_i}} \\
\frac{\partial r_k}{\partial b_j} &amp;= -1
\end{align}
$$
</font>

<h3 id="42-å‡ ä½•å‚æ•°boldsymbol-t_i-boldsymbol-t_j-d-boldsymbol-c">4.2 å‡ ä½•å‚æ•°ï¼ˆ$\boldsymbol T_i, \boldsymbol T_j, d, \boldsymbol c$ï¼‰</h3>

<h4 id="421-å¯¹boldsymbol-t_jboldsymbol-t_içš„åå¯¼">4.2.1 å¯¹$\boldsymbol T_j,\boldsymbol T_i$çš„åå¯¼</h4>

<p>å‡è®¾host frameä¸­çš„ä¸€ä¸ªåƒç´ ç‚¹ä¸º$\boldsymbol p=[u_i, v_i, 1]^T$ï¼Œæ·±åº¦ä¸º$d_i$, è®°$\rho_i=1/d_i$ã€‚è¯¥ç‚¹åœ¨target frameä¸­çš„æŠ•å½±ä¸º</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\rho_j^{-1}\boldsymbol p' &= \underbrace{\boldsymbol K \boldsymbol T_{j}\boldsymbol T_{i}^{-1}}_{\boldsymbol T_{ji}}\underbrace{\boldsymbol K^{-1}\rho_i^{-1}\boldsymbol p}_{\boldsymbol P_i} \\
&= \boldsymbol{KT}_{ji}\boldsymbol P_i \\
&= \boldsymbol K(\boldsymbol R_{ji}\boldsymbol P_i+\boldsymbol t_{ji})
\end{align} %]]></script>

<p>$\boldsymbol P_i = [X_i, Y_i, Z_i]$ä¸ºè¯¥ç‚¹åœ¨hoståæ ‡ç³»ä¸‹çš„ç©ºé—´åæ ‡ã€‚<br />
$\boldsymbol P_j = [X_j, Y_j, Z_j]$ä¸ºè¯¥ç‚¹åœ¨frameåæ ‡ç³»ä¸‹çš„ç©ºé—´åæ ‡ã€‚</p>

<p>$\boldsymbol T_i, \boldsymbol T_j$çš„æä»£æ•°è¡¨ç¤ºåˆ†åˆ«ä¸º$\boldsymbol \xi_{i}ï¼Œ\boldsymbol \xi_{j}$ã€‚</p>

<p>ç”±[1] P163-164å¯çŸ¥ï¼š</p>

<font color="red">
$$
\begin{equation}
\frac{\partial \boldsymbol p'}{\partial \boldsymbol \xi_j} =
\left[
\begin{matrix}
f_x\frac{1}{Z_j} &amp; 0 &amp; -f_x\frac{X_j}{Z_j^2} &amp; -f_x\frac{X_jY_j}{Z_j^2} &amp; f_x+f_x\frac{X_j^2}{Z_j^2} &amp; -f_x\frac{Y_j}{Z_j} \\
0 &amp; f_y\frac{1}{Z_j} &amp; -f_y\frac{Y_j}{Z_j^2} &amp; -f_y-f_y\frac{Y_j^2}{Z_j^2} &amp; f_y\frac{X_jY_j}{Z_j^2} &amp; f_y\frac{Y_j}{Z_j} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
\end{matrix}
\right]
\label{part_p_tj}
\end{equation}
$$
</font>

<p>æ­¤å¤„éœ€è¦æ³¨æ„ï¼Œ[1]ä¸­$\frac{\partial\mathbf{TP}}{\partial\mathbf\xi}$ä¸­$\mathbf T$æ˜¯ç›¸å¯¹äºä¸–ç•Œåæ ‡ç³»çš„ç»å¯¹ä½å§¿ï¼Œè€Œæœ¬æ–‡ä¸­$\mathbf pâ€™=\rho_j\mathbf{K}\mathbf T_{ji}\mathbf P_i$ä¸­çš„$\mathbf T_{ji}$æ˜¯ç›¸å¯¹ä½å§¿ã€‚<br />
å¯ä»¥é€šè¿‡å¦‚ä¸‹å˜æ¢å°†ç›¸å¯¹ä½å§¿å˜æ¢çŸ©é˜µå˜ä¸ºç»å¯¹å˜æ¢çŸ©é˜µã€‚</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
\mathbf p'
&= \rho_j\mathbf{KT}_{j}\mathbf T_i^{-1}\mathbf P_i \\
&= \rho_j\mathbf{KT}_{j}\mathbf P_w
\end{align*} %]]></script>

<p>æˆ–è€…åˆ©ç”¨[3]ä¸­çš„ç»“è®ºï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\frac{\partial\boldsymbol p'}{\partial\mathbf\xi_j}
&= \frac{\partial\rho_j\mathbf{KT}_{ji}\mathbf P_i}{\partial\mathbf\xi_j} \\
&= \underbrace{\frac{\partial\rho_j\mathbf{KT}_{ji}\mathbf P_i}{\partial\mathbf\xi_{ji}}}_{1}\underbrace{\frac{\partial\mathbf\xi_{ji}}{\partial\mathbf\xi_{j}}}_{2} \\
\end{align} %]]></script>

<p>è¿™é‡Œçœç•¥äº†å…¶æ¬¡åæ ‡åˆ°éé½æ¬¡åæ ‡çš„è½¬æ¢ã€‚ä¸Šå¼ä¸­1ä¸ºå¯¹ç»å¯¹ä½å§¿çš„åå¯¼ï¼Œç»“æœä¸º\ref{part_p_tj}ï¼Œæ ¹æ®[3]ä¸­ç»“è®º$\frac{\partial\boldsymbol{\xi}_{ji}}{\partial\boldsymbol\xi_j}=\boldsymbol I$ï¼Œå³2ä¸ºå•ä½é˜µ$\boldsymbol I$ï¼Œå› æ­¤å¯ä»¥å¾—åˆ°å¼\ref{part_p_tj}ã€‚</p>

<p>åŒæ ·ç”±[3]ï¼Œå·²çŸ¥</p>

<script type="math/tex; mode=display">% <![CDATA[
\frac{\partial\boldsymbol{\xi}_{ji}}{\partial\boldsymbol\xi_i}=-\boldsymbol{Ad}_{\boldsymbol T_{ji}} \\
\boldsymbol{Ad}_{\boldsymbol T_{ji}}=
\left[
\begin{matrix}
\boldsymbol R_{ji} & \boldsymbol{t_{ji}^\wedge R_{ji}} \\
\boldsymbol 0 & \boldsymbol R_{ji}
\end{matrix}    
\right] %]]></script>

<p>æ‰€ä»¥</p>

<font color="red">
$$
\begin{align}
\frac{\partial\boldsymbol p'}{\partial\boldsymbol\xi_i}
&amp;= \frac{\partial\rho_j\boldsymbol{KT}_{ji}\boldsymbol P_i}{\partial\boldsymbol\xi_i} \\
&amp;= \frac{\partial\rho_j\boldsymbol{KT}_{ji}\boldsymbol P_i}{\partial\boldsymbol\xi_{ji}}\frac{\partial\boldsymbol\xi_{ji}}{\partial\boldsymbol\xi_{i}} \\
&amp;= -
\left[
\begin{matrix}
f_x\frac{1}{Z_j} &amp; 0 &amp; -f_x\frac{X_j}{Z_j^2} &amp; -f_x\frac{X_jY_j}{Z_j^2} &amp; f_x+f_x\frac{X_j^2}{Z_j^2} &amp; -f_x\frac{Y_j}{Z_j} \\
0 &amp; f_y\frac{1}{Z_j} &amp; -f_y\frac{Y_j}{Z_j^2} &amp; -f_y-f_y\frac{Y_j^2}{Z_j^2} &amp; f_y\frac{X_jY_j}{Z_j^2} &amp; f_y\frac{Y_j}{Z_j} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
\end{matrix}
\right]
\left[
\begin{matrix}
\boldsymbol R_{ji} &amp; \boldsymbol{t_{ji}^\wedge R_{ji}} \\
\boldsymbol 0 &amp; \boldsymbol R_{ji}
\end{matrix}
\right]
\end{align}
$$
</font>

<h4 id="422-å¯¹é€†æ·±åº¦çš„å¯¼æ•°">4.2.2 å¯¹é€†æ·±åº¦çš„å¯¼æ•°</h4>

<p>å®šä¹‰</p>

<script type="math/tex; mode=display">\begin{equation}
\boldsymbol p'=[u_j, v_j, 1]=\boldsymbol K[u, v, 1]^T=\rho_j\boldsymbol K(\boldsymbol R_{ji}\boldsymbol P_i+\boldsymbol t_{ji})
\label{p_asp}
\end{equation}</script>

<p>å…¶ä¸­$[u, v, 1]^T$ä¸ºå½’ä¸€åŒ–å¹³é¢çš„åæ ‡ï¼Œåˆ™æœ‰ï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\frac{\partial \boldsymbol p'}{\partial \rho_i}&=
\left[
\begin{matrix}
\frac{\partial u_j}{\partial \rho_i} & \frac{\partial v_j}{\partial \rho_i} & 0
\end{matrix}
\right]^T \\
&=\left[
\begin{matrix}
\frac{\partial u_j}{\partial u}\cdot\frac{\partial u}{\partial \rho_i} & \frac{\partial v_j}{\partial v}\cdot\frac{\partial v}{\partial \rho_i} & 0
\end{matrix}
\right]^T
\end{align} %]]></script>

<p>ä¸”</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
[u,v,1]^T&=\rho_j(\boldsymbol R_{ji}\boldsymbol P_i+\boldsymbol t_{ji}) \\
&=\rho_j(\boldsymbol R_{ji}\boldsymbol K^{-1}\rho_i^{-1}\boldsymbol p+\boldsymbol t_{ji})
\end{align} %]]></script>

<p>è®°$\boldsymbol a=\boldsymbol R_{ji}\boldsymbol K^{-1}\boldsymbol p$ï¼Œåˆ™</p>

<script type="math/tex; mode=display">\begin{equation}
[u,v,1]^T=\rho_j(\rho_i^{-1}\boldsymbol a+\boldsymbol t_{ji})
\end{equation}</script>

<p>å³</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{equation}
\left\{
\begin{aligned}
u &= \rho_j(\rho_i^{-1}\boldsymbol a^1+\boldsymbol t_{ji}^1) \\
v &= \rho_j(\rho_i^{-1}\boldsymbol a^2+\boldsymbol t_{ji}^2) \\
1 &= \rho_j(\rho_i^{-1}\boldsymbol a^3+\boldsymbol t_{ji}^3)\end{aligned}
\right.
\label{u_v_1}
\end{equation} %]]></script>

<p>å…¶ä¸­ï¼Œ$\boldsymbol{a,t}$çš„ä¸Šæ ‡$i$è¡¨ç¤ºå–ç¬¬$i$è¡Œã€‚æ¶ˆå»$\rho_j$ï¼Œåˆ™</p>

<script type="math/tex; mode=display">\begin{equation}
u = \frac{u}{1} = \frac{\rho_j(\rho_i^{-1}\boldsymbol a^1+\boldsymbol t_{ji}^1)}{\rho_j(\rho_i^{-1}\boldsymbol a^3+\boldsymbol t_{ji}^3)} = \frac{\boldsymbol a^1+\rho_i\boldsymbol t_{ji}^1}{\boldsymbol a^3+\rho_i\boldsymbol t_{ji}^3} 
\label{u}
\end{equation}</script>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\frac{\partial u}{\partial\rho_i}&=\frac{\boldsymbol t_{ji}^1(\boldsymbol a^3+\rho_i\boldsymbol t_{ji}^3)-\boldsymbol t_{ji}^3(\boldsymbol a^1+\rho_i\boldsymbol t_{ji}^1)}{(\boldsymbol a^3+\rho_i\boldsymbol t_{ji}^3)^2} \\
&=\frac{\boldsymbol t_{ji}^1-u\boldsymbol t_{ji}^3}{\boldsymbol a^3+\rho_i\boldsymbol t_{ji}^3} \\
&=(\boldsymbol t_{ji}^1-u\boldsymbol t_{ji}^3)\frac{\rho_j}{\rho_i}
\end{align} %]]></script>

<p>å…¶ä¸­ï¼Œç¬¬ä¸‰ä¸ªç­‰å·ç”±å…¬å¼\ref{u_v_1}çš„3å¼è€Œæ¥ã€‚<br />
åŒç†</p>

<script type="math/tex; mode=display">\begin{equation}
\frac{\partial v}{\partial\rho_i}=(\boldsymbol t_{ji}^2-u\boldsymbol t_{ji}^3)\frac{\rho_j}{\rho_i}
\end{equation}</script>

<p>ç”±å…¬å¼\ref{p_asp}å¯å¾—ï¼š</p>

<script type="math/tex; mode=display">\begin{equation}
\left[
\begin{matrix}
u_j \\
v_j \\
1
\end{matrix}
\right]=
\left[
\begin{matrix}
f_xu+c_x \\
f_yv+c_y \\
1
\end{matrix}
\right] ,
\left[
\begin{matrix}
\frac{\partial u_j}{\partial u} \\
\frac{\partial v_j}{\partial v}
\end{matrix}
\right]=
\left[
\begin{matrix}
f_x \\
f_y
\end{matrix}
\right]
\label{part_u_j_u}
\end{equation}</script>

<p>æ‰€ä»¥</p>

<font color="red">
$$
\begin{align}
\frac{\partial \boldsymbol p'}{\partial \rho_i}
&amp;=\left[
\begin{matrix}
\frac{\partial u_j}{\partial u}\cdot\frac{\partial u}{\partial \rho_i} \\
\frac{\partial v_j}{\partial v}\cdot\frac{\partial v}{\partial \rho_i} \\
0
\end{matrix}
\right] \\
&amp;=
\left[
\begin{matrix}
f_x(\boldsymbol t_{ji}^1-u\boldsymbol t_{ji}^3)\frac{\rho_j}{\rho_i} \\
f_y(\boldsymbol t_{ji}^2-u\boldsymbol t_{ji}^3)\frac{\rho_j}{\rho_i} \\
0
\end{matrix}
\right]
\end{align}
$$
</font>

<p>é€šè¿‡å¼\ref{u_v_1}æ¶ˆå»$\rho_i$ï¼Œåˆ™</p>

<p><script type="math/tex">\begin{equation*}
\frac{u-\rho_j\boldsymbol t_{ji}^1}{1-\rho_j\boldsymbol t_{ji}^3}=\frac{\boldsymbol a^1}{\boldsymbol a^3} \\
u = \frac{\boldsymbol a^1}{\boldsymbol a^3}+(\boldsymbol t_{ji}^1-\frac{\boldsymbol a^1}{\boldsymbol a^3}\boldsymbol t_{ji}^3)\rho_j \\
\end{equation*}</script><script type="math/tex">% <![CDATA[
\begin{align}
\frac{\partial u}{\partial\rho_j} 
&= \boldsymbol t_{ji}^1-\frac{\boldsymbol a^1}{\boldsymbol a^3}\boldsymbol t_{ji}^3 \\
&= (\boldsymbol t_{ji}^1-u\boldsymbol t_{ji}^3)\frac{1}{1-\rho_j\boldsymbol t_{ji}^3}
\end{align} %]]></script></p>

<p>åŒç†</p>

<script type="math/tex; mode=display">\frac{\partial v}{\partial\rho_j} = (\boldsymbol t_{ji}^2-v\boldsymbol t_{ji}^3)\frac{1}{1-\rho_j\boldsymbol t_{ji}^3}</script>

<p>æ‰€ä»¥</p>

<font color="red">
$$
\begin{align}
\frac{\partial \boldsymbol p'}{\partial \rho_j}
&amp;=\left[
\begin{matrix}
\frac{\partial u_j}{\partial u}\cdot\frac{\partial u}{\partial \rho_j} \\
\frac{\partial v_j}{\partial v}\cdot\frac{\partial v}{\partial \rho_j} \\
0
\end{matrix}
\right] \\
&amp;=
\left[
\begin{matrix}
f_x(\boldsymbol t_{ji}^1-u\boldsymbol t_{ji}^3)\frac{1}{1-\rho_j\boldsymbol t_{ji}^3} \\
f_y(\boldsymbol t_{ji}^2-u\boldsymbol t_{ji}^3)\frac{1}{1-\rho_j\boldsymbol t_{ji}^3} \\
0
\end{matrix}
\right]
\end{align}
$$
</font>

<h4 id="423-å¯¹å†…å‚çš„åå¯¼">4.2.3 å¯¹å†…å‚çš„åå¯¼</h4>

<p>å¯¹$f_x, f_y$ï¼š</p>

<script type="math/tex; mode=display">\begin{equation}
\boldsymbol p'=
\left[
\begin{matrix}
f_xu+c_x \\
f_yv+c_y \\
1
\end{matrix}
\right]
\end{equation}</script>

<p>æ˜“å¾—$\frac{\partial v}{\partial f_x}=0$, æ‰€ä»¥</p>

<script type="math/tex; mode=display">\begin{equation}
\frac{\partial \boldsymbol p'}{\partial f_x}=
\left[
\begin{matrix}
u+f_x\frac{\partial u}{\partial f_x}\\
0 \\
0
\end{matrix}
\right]=
\left[
\begin{matrix}
u+f_x\frac{\partial u}{\partial\boldsymbol P_i^T}\frac{\partial\boldsymbol P_i}{\partial\boldsymbol f_x}\\
0 \\
0
\end{matrix}
\right]
\end{equation}</script>

<p>ç”±å¼\ref{u}å¯çŸ¥</p>

<script type="math/tex; mode=display">u = \frac{\rho_i^{-1}\boldsymbol r_1\overbrace{\boldsymbol K^{-1}\boldsymbol p}^{\boldsymbol P_i}+t_1}{\rho_i^{-1}\boldsymbol r_3\boldsymbol K^{-1}\boldsymbol p+t_3}=\frac{\rho_i^{-1}\boldsymbol r_1\boldsymbol P_i+t_1}{\rho_i^{-1}\boldsymbol r_3\boldsymbol P_i+t_3}</script>

<p>å…¶ä¸­$\boldsymbol r_1=\boldsymbol R_{ji}^1, t_1=\boldsymbol t_{ji}^1,\boldsymbol r_3=\boldsymbol R_{ji}^3, t_3=\boldsymbol t_{ji}^3$ï¼Œåˆ™</p>

<script type="math/tex; mode=display">\begin{equation}
\frac{\partial u}{\partial\boldsymbol P_i^T}=
\left(
    \frac{\rho_i^{-1}(\boldsymbol r_1-u\boldsymbol r_3)}{\rho_i^{-1}\boldsymbol r_3\boldsymbol P_i+t_3}
\right)^T=\frac{\rho_j}{\rho_i}(\boldsymbol r_1^T-u\boldsymbol r_3^T)
\end{equation}</script>

<script type="math/tex; mode=display">% <![CDATA[
\boldsymbol P_i= \boldsymbol K^{-1}\boldsymbol p=
\left[
\begin{matrix}
f_x^{-1} & 0 & -f_x^{-1}c_x \\
0 & f_y^{-1} & -f_y^{-1}c_y \\
0 & 0 & 1
\end{matrix}
\right] 
\left[
\begin{matrix}
u_i \\
v_i \\
1
\end{matrix}
\right]=
\left[
\begin{matrix}
f_x^{-1}u_i-f_x^{-1}c_x \\
f_y^{-1}v_i-f_y^{-1}c_y \\
1
\end{matrix}
\right]
\\ %]]></script>

<script type="math/tex; mode=display">\begin{equation}
\frac{\partial \boldsymbol P_i'}{\partial f_x}=
\left[
\begin{matrix}
-f_x^{-2}(u_i-c_x) \\
0 \\
0
\end{matrix}
\right]=
\left[
\begin{matrix}
-uf_x^{-1} \\
0 \\
0
\end{matrix}
\right]
\end{equation}</script>

<p>æ‰€ä»¥</p>

<font color="red">
$$
\begin{align}
\frac{\partial u}{\partial f_x}&amp;=-\frac{\rho_j}{\rho_i}(r_{11}-ur_{31})uf_x^{-1} \\
\frac{\partial \boldsymbol p'}{\partial f_x}&amp;=
\left[
\begin{matrix}
u-u\frac{\rho_j}{\rho_i}(r_{11}-ur_{31}) \\
0 \\
0
\end{matrix}
\right]
\end{align}
$$
</font>

<p>åŒç†å¯å¾—</p>

<font color="red">
$$
\begin{equation}
\frac{\partial \boldsymbol p'}{\partial f_y}=
\left[
\begin{matrix}
0 \\
v-v\frac{\rho_j}{\rho_i}(r_{21}-vr_{31}) \\
0
\end{matrix}
\right]
\end{equation}
$$
</font>

<p>å¯¹$c_x, c_y$ï¼š</p>

<script type="math/tex; mode=display">\begin{equation}
\frac{\partial \boldsymbol p'}{\partial c_x}=
\left[
\begin{matrix}
1+f_x\frac{\partial u}{\partial c_x}\\
0 \\
0
\end{matrix}
\right]=
\left[
\begin{matrix}
1+f_x\frac{\partial u}{\partial\boldsymbol P_i^T}\frac{\partial\boldsymbol P_i}{\partial\boldsymbol c_x}\\
0 \\
0
\end{matrix}
\right] \\
\frac{\partial \boldsymbol P_i}{\partial c_x}=
\left[
\begin{matrix}
-f_x^{-1} \\
0 \\
0
\end{matrix}
\right] \\
\end{equation}</script>

<p>æ‰€ä»¥</p>

<font color="red">
$$
\begin{equation}
\frac{\partial \boldsymbol p'}{\partial c_x}=
\left[
\begin{matrix}
1-\frac{\rho_j}{\rho_i}(r_{11}-ur_{31})\\
0 \\
0
\end{matrix}
\right]
\end{equation}
$$</font>

<p>åŒç†å¯å¾—</p>

<font color="red">
$$
\begin{equation}
\frac{\partial \boldsymbol p'}{\partial c_y}=
\left[
\begin{matrix}
0 \\
1-\frac{\rho_j}{\rho_i}(r_{21}-ur_{31})\\
0
\end{matrix}
\right]
\end{equation}
$$
</font>

<h2 id="5-visual-odomtery-front-end">5. Visual Odomtery Front-end</h2>

<p>å‰ç«¯è´Ÿè´£å¸§å’Œç‚¹çš„ç®¡ç†ï¼ˆé€‰å–åŠè¾¹ç¼˜åŒ–ï¼Œç§»é™¤outlieråŠé®æŒ¡ç‚¹ï¼‰ï¼Œå¹¶ä¸”ä¸ºæ–°åŠ å…¥çš„å˜é‡æä¾›ä¼˜åŒ–åˆå€¼ã€‚</p>

<h3 id="51-å¸§ç®¡ç†">5.1 å¸§ç®¡ç†</h3>

<p>æ»‘åŠ¨çª—å£ä¸­æ€»æ˜¯ä¿æŒ7ä¸ªactive frameï¼Œæ–°æ¥çš„å¸§å°†æ ¹æ®è¿™äº›active frameè¿›è¡Œtrackingï¼Œç„¶åå†³å®šè¯¥å¸§æ˜¯å¦æˆä¸ºä¸€ä¸ªå…³é”®å¸§ï¼Œè‹¥å¦ï¼Œåˆ™ä¸¢å¼ƒè¯¥å¸§ï¼Œå¦åˆ™ä¼˜åŒ–å…‰åº¦è¯¯å·®ï¼Œæœ€åè¾¹ç¼˜åŒ–å…¶ä»–å¸§ã€‚</p>

<ol>
  <li>Frame tracking
 æ–°å…³é”®å¸§åˆ›å»ºåï¼Œå°†å…¶ä»–active frameä¸­çš„active pointå…¨éƒ¨æŠ•å½±åˆ°æœ€æ–°å…³é”®å¸§ï¼Œæ–°æ¥çš„frameåªéœ€æ ¹æ®è¿™ä¸€å¸§è¿›è¡Œtrackingï¼Œåˆå§‹å€¼æ ¹æ®åŒ€é€Ÿè¿åŠ¨æ¨¡å‹å’Œå›¾åƒé‡‘å­—å¡”<font color="blue">ï¼ˆå›¾åƒé‡‘å­—å¡”çš„ä½œç”¨ï¼Ÿï¼‰</font>å¾—åˆ°ï¼Œè‹¥trackingå¤±è´¥ï¼Œåˆ™åœ¨27ä¸ªä¸åŒçš„æ–¹å‘é‡æ–°åˆå§‹åŒ–<font color="blue">ï¼ˆï¼Ÿï¼‰</font>ã€‚</li>
  <li>å…³é”®å¸§çš„é€‰æ‹©
 ç­–ç•¥ï¼šé¦–å…ˆå°½å¯èƒ½å¤šçš„åˆ›å»ºå…³é”®å¸§ï¼Œç„¶åå†è¾¹ç¼˜åŒ–æ‰ã€‚
 é€‰å–å‡†åˆ™ï¼š
    <ol>
      <li>è§†è§’å˜æ¢å¤§</li>
      <li>å¹³ç§»è¾ƒå¤§</li>
      <li>æ›å…‰æ—¶é—´å˜åŒ–å¤§
 æœ€ç»ˆé€šè¿‡è¿™ä¸‰ä¸ªå‡†åˆ™çš„åŠ æƒåˆ†æ•°å†³å®šæ˜¯å¦åˆ›å»ºæ–°çš„å…³é”®å¸§ã€‚</li>
    </ol>
  </li>
  <li>å…³é”®å¸§çš„è¾¹ç¼˜åŒ–
    <ol>
      <li>æœ€æ–°ä¸¤å¸§ä¸€å®šä¿ç•™ã€‚</li>
      <li>æŸä¸€å¸§ä¸­çš„active pointä¸­å°‘äº5%è¢«æœ€æ–°çš„active frameè§‚æµ‹åˆ°ï¼Œåˆ™è¾¹ç¼˜åŒ–è¯¥å¸§ã€‚</li>
      <li>è¾¹ç¼˜åŒ–æ‰ç¦»æœ€æ–°å…³é”®å¸§è¿œï¼Œä½†ç¦»å…¶ä»–å…³é”®å¸§è¿‘çš„å…³é”®å¸§ã€‚</li>
    </ol>
  </li>
</ol>

<h3 id="52-ç‚¹ç®¡ç†">5.2 ç‚¹ç®¡ç†</h3>

<p>æ€»çš„active pointä¸º2000ä¸ªï¼Œä½¿ä»–ä»¬å°½å¯èƒ½åœ¨æ•´ä¸ªç©ºé—´åŠactive frameä¸Šå‡åŒ€åˆ†å¸ƒã€‚é¦–å…ˆåœ¨æ¯ä¸ªæ–°çš„å…³é”®å¸§ä¸Šé€‰æ‹©2000ä¸ªå€™é€‰ç‚¹ï¼Œå¹¶ä¸”é€šè¿‡åç»­çš„trackingå¾—åˆ°åˆå§‹æ·±åº¦å€¼ï¼Œç„¶åé€‰æ‹©éƒ¨åˆ†å€™é€‰ç‚¹æˆä¸ºactive pointã€‚</p>

<ol>
  <li>å€™é€‰ç‚¹çš„é€‰æ‹©
 å°½å¯èƒ½é€‰æ‹©åœ¨å›¾åƒä¸­åˆ†å¸ƒå‡åŒ€ï¼Œå¹¶ä¸”æ¢¯åº¦è¾ƒå¤§çš„ç‚¹ã€‚</li>
  <li>å€™é€‰ç‚¹çš„tracking
 æ²¿æçº¿æœç´¢ï¼Œæœ€å°åŒ–å…‰åº¦è¯¯å·®å¾—åˆ°æ·±åº¦å€¼å’Œassociated variance<font color="blue">ï¼ˆï¼Ÿï¼‰</font>ã€‚</li>
  <li>å€™é€‰ç‚¹æ¿€æ´»
 å°†æ‰€æœ‰active pointæŠ•å½±åˆ°æ–°çš„å…³é”®å¸§ä¸Šï¼Œé€‰æ‹©ä¸å·²å­˜åœ¨çš„active pointè·ç¦»æœ€å¤§çš„ç‚¹æ¿€æ´»<font color="blue">ï¼ˆå…·ä½“ç­–ç•¥ï¼Ÿä¸ä¸€ä¸ªç‚¹è¿˜æ˜¯æ‰€æœ‰ç‚¹è·ç¦»ä¹‹å’Œï¼Ÿï¼‰</font>ã€‚</li>
</ol>

<p>[8]æ¨å¯¼äº†å¦‚ä½•ä»å¤šå…ƒé«˜æ–¯åˆ†å¸ƒè”åˆç›–æ¦‚ç‡å¯†åº¦$p(a,b)$å¾—åˆ°éƒ¨åˆ†å˜é‡çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦$p(a|b)$ã€‚
[9]è¯´æ˜äº†å¤šå…ƒé«˜æ–¯åˆ†å¸ƒä¸­åæ–¹å·®çŸ©é˜µçš„é€†$\sum^{-1}$ç­‰äºHessiançŸ©é˜µ$H$ã€‚</p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ol>
  <li>é«˜ç¿”, å¼ æ¶›, åˆ˜æ¯…, é¢œæ²ç¿, è§†è§‰SLAMåå››è®²ï¼šä»ç†è®ºä¸å®è·µ,ç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾, 2017</li>
  <li><a href="https://zhuanlan.zhihu.com/p/29177540">DSOè¯¦è§£</a></li>
  <li><a href="https://www.cnblogs.com/JingeTU/p/9077372.html">Adjoint of SE(3)</a></li>
  <li><a href="https://www.jianshu.com/p/4128e5b31fb4">é—²è¯çŸ©é˜µæ±‚å¯¼</a></li>
  <li><a href="https://www.cnblogs.com/luyb/p/6077478.html">DSOä¹‹å…‰åº¦æ ‡å®š</a></li>
  <li><a href="https://blog.csdn.net/weixin_41394379/article/details/89706298">æ»‘çª—ä¼˜åŒ–ã€è¾¹ç¼˜åŒ–ã€èˆ’å°”è¡¥ã€FEJåŠfill-iné—®é¢˜</a></li>
  <li><a href="https://blog.csdn.net/heyijia0327/article/details/53707261">DSO ä¸­çš„Windowed Optimization</a></li>
  <li><a href="https://gbhqed.wordpress.com/2010/02/21/conditional-and-marginal-distributions-of-a-multivariate-gaussian/">Conditional and marginal distributions of a multivariate Gaussian</a></li>
  <li><a href="https://onlinelibrary.wiley.com/doi/pdf/10.1002/9780470824566.app1">Relationship between the Hessian and Covariance Matrix for Gaussian Random Variables</a></li>
  <li><a href="https://www.zhihu.com/question/59784440/answer/170886408">å¦‚ä½•ç†è§£EKFä¸­çš„consistencyï¼Ÿ - jingèƒ–çš„å›ç­”</a></li>
</ol>
:ET